<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">       
    <link rel="stylesheet" href="../planometas/static/css/bootstrap.min.css" />
    <link rel="stylesheet" href="../planometas/static/css/plr.css" />
    <link type="text/css" rel="stylesheet" href="../planometas/static/css/jsgrid.min.css" />
    <link type="text/css" rel="stylesheet" href="../planometas/static/css/jsgrid-theme.min.css" />
    <link rel="stylesheet" href="../planometas/static/css/jquery-ui.css">
    <link rel="stylesheet" href="../planometas/static/css/iao-alert.css">
    <link rel="stylesheet" href="../planometas/static/css/all.css" />
</head>
<body>
     <!-- HEADER -->
     <nav id="idHeader" class="navbar navbar-ligth plr-nav align-top">
         <div class="d-inline-block">               
            <a class="navbar-brand plr-logo" href="home.html">
                <img class="align-top plr-logo-img" src="static/images/logo.png" alt="PLR">
            </a>
            <a class="navbar-brand plr-logo" href="home.html">
                    <img src="static/images/logo-name.png" 
                    srcset="static/images/logo-name.svg" alt="Nome Logo">
            </a>
        </div>
        <div id="idMensagemSessao" class="navbar-nav ml-md-auto mr-md-4 plr-welcome-msg">
            <i class="fas fa-user-circle mb-1" title="Usuário Logado" style="margin-right: 2px; color: white;">
                    <span id="idNomeUsuarioLogado"></span>
            </i>
            <i class="fas fa-calendar-alt mb-1" title="Período PLR Ativo" style="margin-right: 2px; color: white;">
                <span id="idPeriodoPLRAtivo"></span>
            </i>
            <i class="fas fa-clock" title="Tempo restante de sessão" style="margin-right: 2px; color: white;">
                    <span id="idTempoRestante"></span>
            </i>
       </div>
      </nav>
    <!-- FIM HEADER -->

    <!-- SIDE MENU-->
        <div class="nav nav-pills plr-navside" id="v-pills-tab" role="tablist" aria-orientation="vertical">
            <a class="nav-link active" id="home-tab" data-toggle="pill" href="#home" 
               role="tab" aria-controls="home" aria-selected="true">
               <i class="fas fa-home" style="margin-right: 2px; color: #003cbe;"></i><span class="plr-menu-item">Home</span></a>
            
            <a class="nav-link" id="cadastros-tab" data-toggle="pill" href="#cadastros" 
               role="tab" aria-controls="cadastros" aria-selected="false">
               <i class="fas fa-folder-plus" style="margin-right: 2px; color: #003cbe;"></i><span class="plr-menu-item">Cadastros</span></a>
            
            <a class="nav-link" id="metas-tab" data-toggle="pill" href="#metas" 
               role="tab" aria-controls="metas" aria-selected="false">
               <i class="fas fa-chart-line" style="margin-right: 2px; color: #003cbe;"></i><span class="plr-menu-item">Metas</span></a>
            
           <a class="nav-link" id="config-tab" data-toggle="pill" href="#config" 
               role="tab" aria-controls="config" aria-selected="false">
               <i class="fas fa-wrench" style="margin-right: 2px; color: #003cbe;"></i><span class="plr-menu-item">Configurações</span></a>
            
           <a class="nav-link" id="sair-tab" data-toggle="pill" href="#sair" 
               role="tab" aria-controls="sair" aria-selected="false" onclick="logout()">
               <i class="fas fa-sign-out-alt" style="margin-right: 2px; color: #003cbe;"></i><span class="plr-menu-item">Sair</span></a>                
        </div>
        <div class="container-fluid">
            <div class="col-md-12 mt-2">
                <div class="tab-content" id="v-pills-tabContent">
                    <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
                        <div w3-include-html="templates/metas/metasPesquisa.html"></div>
                    </div>
                    <div class="tab-pane fade" id="cadastros" role="tabpanel" aria-labelledby="cadastros-tab">
                        <div w3-include-html="templates/administracao/administracao.html"></div>
                    </div>
                    <div class="tab-pane fade" id="metas" role="tabpanel" aria-labelledby="metas-tab">
                        <div w3-include-html="templates/metas/metasCadastro.html"></div>
                    </div>
                    <div class="tab-pane fade" id="config" role="tabpanel" aria-labelledby="config-tab">
                    </div>
                    <div class="tab-pane fade" id="sair" role="tabpanel" aria-labelledby="sair-tab">
                    </div>
                </div>
            </div>
        </div>

    <!--FOOTER-->
    <div class="row">
        <div class="col-md-12 plr-footer">
            <p>© Copyright : Focus Quality|v2.1.0|2019</p>
        </div>
    </div>

    <div id="dialogPrimeiroAcesso" title="Redefinir Senha Inicial">
        <form>
            <div class="col-md-auto mt-2">
                <label for="newPassword">Nova senha:</label>
                <div class="input-group">
                    <input type="password" placeholder = "Digite a nova senha" id="idNewPassword" class="form-control" maxlength="6" />
                </div>
            </div>
            <div class="col-md-auto mt-2">
                <label for="confirmPassword">Confirmar nova senha:</label>
                <div class="input-group">
                    <input type="password" id="idConfirmNewPassword" placeholder = "Confirme a nova senha"  class="form-control" maxlength="6" />
                </div>
            </div>
            <hr>
            <div class="col-md-auto mt-2">
                    <button id="btnResetPassword" class="btn btn-success btn-sm" onclick="authController.redefineSenha()">Salvar
            </div>
        </form>
    </div>
    <div class="modalLoading">
            <h5 style="text-align: center;vertical-align: middle; margin-top: 23%; font-weight: bold;">Processando a solicitação...</h5>
    </div>

    <script type="text/javascript" src="../planometas/static/js/jquery-3.3.1.js"></script>
    <script type="text/javascript" src="../planometas/static/js/w3.js"></script>
    <script type="text/javascript" src="../planometas/static/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../planometas/static/js/bootstrap.js"></script>
    <script type="text/javascript" src="../planometas/static/js/jsgrid.min.js"></script>
    <script type="text/javascript" src="../planometas/static/js/jquery-ui.js"></script>
    <script type="text/javascript" src="../planometas/static/js/crypto-js.js"></script>
    <script type="text/javascript" src="../planometas/static/js/accounting.js"></script>
    <script type="text/javascript" src="../planometas/static/js/printThis/printThis.js"></script>
    <script type="text/javascript" src="../planometas/static/js/MessageView.js"></script>
    <script type="text/javascript" src="../planometas/static/js/Validation.js"></script>
    <script type="text/javascript" src="../planometas/static/js/iao-alert.jquery.min.js"></script>

    <script type="text/javascript" src="../planometas/static/js/PLRController.js"></script>
    <script type="text/javascript" src="../planometas/static/js/PLRBusiness.js"></script>
    <script type="text/javascript" src="../planometas/static/js/colaborador/ColaboradorController.js"></script>
    <script type="text/javascript" src="../planometas/static/js/cardapioMetas/CardapioMetasController.js"></script>
    <script type="text/javascript" src="../planometas/static/js/metaMensal/MetaMensalController.js"></script>
    <script type="text/javascript" src="../planometas/static/js/metas/MetasController.js"></script>
    <script type="text/javascript" src="../planometas/static/js/perfil/PerfilController.js"></script>
    <script type="text/javascript" src="../planometas/static/js/auth/AuthController.js"></script>
    <script type="text/javascript" src="../planometas/static/js/itemMetas/ItemMetasController.js"></script>

    <script type="text/javascript" src="../planometas/static/js/colaborador/ColaboradorBusiness.js"></script>
    <script type="text/javascript" src="../planometas/static/js/cardapioMetas/CardapioMetasBusiness.js"></script>
    <script type="text/javascript" src="../planometas/static/js/itemMetas/ItemMetasBusiness.js"></script>
    <script type="text/javascript" src="../planometas/static/js/metaMensal/MetaMensalBusiness.js"></script>
    <script type="text/javascript" src="../planometas/static/js/perfil/PerfilBusiness.js"></script>
    <script type="text/javascript" src="../planometas/static/js/metas/MetasBusiness.js"></script>
    <script type="text/javascript" src="../planometas/static/js/auth/AuthBusiness.js"></script>
    <script type="text/javascript" src="../planometas/static/js/helper.js"></script>
  
    <script type="text/javascript">
        var metasController;
        var colaboradorController;
        var cardapioMetasController;
        var itemMetasController;
        var metaMensalController;

        var plrController = new PLRController();
        var authController = new  AuthController();
        if (authController.checkActiveSession()) {
            authController.redirectToLogin();
        } else {
        //  authController.openDialogPrimeiroAcesso();
        }

                
        function initJSContext () {
            metasController = new MetasController();
            cardapioMetasController = new CardapioMetasController();
            colaboradorController = new ColaboradorController();
            itemMetasController = new ItemMetasController();
            metaMensalController = new MetaMensalController();
        }

        function logout() {
            authController.logout();
        }

        plrController.writeSessionMessage();              

        $(document).ready(
            function() {
                w3.includeHTML(initJSContext);  
                setInterval(function() {
                    if (sessionRemainingMin() <= 0) {
                        logout();
                        resetBrowserSession();
                    }   
                    
                    plrController.writeSessionMessage();
                }, 60000); 
            }
        );

        
    </script>
</body>
</html>